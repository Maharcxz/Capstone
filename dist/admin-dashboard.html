<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Dashboard - Trinity Optimum Vision Center</title>
    
    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@300;400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    
    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    
    <!-- Firebase Configuration -->
    <script src="JS/FirebaseConfig.js"></script>
    <script src="JS/AuthHandlers.js"></script>


  <link rel="stylesheet" crossorigin href="/assets/admin-dashboard-CUcon34c.css">
  <link rel="stylesheet" crossorigin href="/assets/HeaderStyles-BGGMSg_O.css">
  <link rel="stylesheet" crossorigin href="/assets/SidebarStyles-Bk2AS0AO.css">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <h1 class="maintitle">T R I N I T Y</h1>
                <p class="subtitle">OPTIMUM VISION CENTER</p>
            </div>
            <nav class="nav">
                <div class="nav-left">
                    <a href="index.html" class="nav-link">
                        <span>Home</span>
                    </a>
                    <a href="contact.html" class="nav-link">
                        <span>Contact Us</span>
                    </a>
                    <a href="about.html" class="nav-link">
                        <span>About Us</span>
                    </a>

                    <a href="preorders.html" class="nav-link admin-only" id="preOrdersNav" style="display: none;">
                        <span>Pre-Orders</span>
                    </a>
                    <a href="admin-dashboard.html" class="nav-link admin-only" id="productManagementNav" style="display: none;">
                        <span>Product Management</span>
                    </a>
                </div>
                <div class="nav-right">
                    <div class="nav-icons">
                        <div class="preorder-notification-wrapper admin-only" style="display: none;">
                            <span class="preorder-bell-icon" onclick="togglePreorderNotifications()" title="New Pre-Orders">
                                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <path d="M18 8A6 6 0 0 0 6 8c0 7-3 9-3 9h18s-3-2-3-9"></path>
                                    <path d="M13.73 21a2 2 0 0 1-3.46 0"></path>
                                </svg>
                            </span>
                            <span class="preorder-notification-badge" id="preorderNotificationBadge">0</span>
                        </div>
                    </div>
                    <div class="auth-section">
                        <a href="#" class="login-btn" id="authButton" onclick="handleAuthClick()">
                            <span class="user-icon">ðŸ‘¤</span>
                            <span id="authButtonText">Log In</span>
                        </a>
                        <div class="admin-dropdown" id="adminDropdown">
                            <button class="dropdown-item" onclick="navigateToPreorders()">
                                <span class="dropdown-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 5H7a2 2 0 00-2 2v10a2 2 0 002 2h8a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2m-3 7h3m-3 4h3m-6-4h.01M9 16h.01"/>
                                    </svg>
                                </span>
                                <span>Pre-Orders</span>
                            </button>
                            <button class="dropdown-item" onclick="toggleContentManagement()">
                                <span class="dropdown-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M11 4H4a2 2 0 00-2 2v14a2 2 0 002 2h14a2 2 0 002-2v-7"/>
                                        <path d="M18.5 2.5a2.121 2.121 0 013 3L12 15l-4 1 1-4 9.5-9.5z"/>
                                    </svg>
                                </span>
                                <span>Content Management</span>
                            </button>
                            <button class="dropdown-item" onclick="toggleUserManagement()">
                                <span class="dropdown-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M17 21v-2a4 4 0 00-4-4H5a4 4 0 00-4 4v2"/>
                                        <circle cx="9" cy="7" r="4"/>
                                        <path d="M23 21v-2a4 4 0 00-3-3.87"/>
                                        <path d="M16 3.13a4 4 0 010 7.75"/>
                                    </svg>
                                </span>
                                <span>User Management</span>
                            </button>
                            <button class="dropdown-item" onclick="toggleAdminSettings()">
                                <span class="dropdown-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <circle cx="12" cy="12" r="3"/>
                                        <path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 010 2.83 2 2 0 01-2.83 0l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-2 2 2 2 0 01-2-2v-.09A1.65 1.65 0 009 19.4a1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83 0 2 2 0 010-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 01-2-2 2 2 0 012-2h.09A1.65 1.65 0 004.6 9a1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 010-2.83 2 2 0 012.83 0l.06.06a1.65 1.65 0 001.82.33H9a1.65 1.65 0 001-1.51V3a2 2 0 012-2 2 2 0 012 2v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 0 2 2 0 010 2.83l-.06.06a1.65 1.65 0 00-.33 1.82V9a1.65 1.65 0 001.51 1H21a2 2 0 012 2 2 2 0 01-2 2h-.09a1.65 1.65 0 00-1.51 1z"/>
                                    </svg>
                                </span>
                                <span>Settings</span>
                            </button>
                            <hr class="dropdown-divider">
                            <button class="dropdown-item logout-item" onclick="switchToGuestMode()">
                                <span class="dropdown-icon">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                        <path d="M9 21H5a2 2 0 01-2-2V5a2 2 0 012-2h4"/>
                                        <polyline points="16,17 21,12 16,7"/>
                                        <line x1="21" y1="12" x2="9" y2="12"/>
                                    </svg>
                                </span>
                                <span>Logout</span>
                            </button>
                        </div>
                    </div>
                </div>
            </nav>
        </header>

    </div>

    <!-- Sidebar Overlay -->
    <div class="sidebar-overlay" id="sidebarOverlay"></div>

    <!-- Sidebar -->
    <div class="sidebar" id="frameSidebar">
        <div class="sidebar-content" id="sidebarContent">
            <!-- Categories will be loaded here dynamically -->
        </div>
    </div>

    <div class="admin-dashboard">
        <!-- Header -->
        <div class="dashboard-header">
            <h1 class="dashboard-title">ADMIN DASHBOARD</h1>
            <p class="dashboard-subtitle">Product Management System</p>
        </div>

        <!-- Toolbar Section -->
        <div class="toolbar-section">
            <div class="toolbar-left">

                <div class="search-container">
                    <svg class="search-icon" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <circle cx="11" cy="11" r="8"></circle>
                        <path d="m21 21-4.35-4.35"></path>
                    </svg>
                    <input type="text" class="search-input" id="productSearch" placeholder="Search products..." onkeyup="filterProducts()">
                </div>
                <select class="filter-select" id="categoryFilter" onchange="filterProducts()">
                    <option value="">All Categories</option>
                    <!-- Categories will be loaded dynamically -->
                </select>
                <select class="filter-select" id="visibilityFilter" onchange="filterProducts()">
                    <option value="">All Products</option>
                    <option value="visible">Visible Only</option>
                    <option value="hidden">Hidden Only</option>
                </select>
            </div>
            <div class="toolbar-right">
                <button class="add-category-btn" onclick="openSidebarManagerModal()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <path d="M22 19a2 2 0 01-2 2H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h9a2 2 0 012 2z"></path>
                        <line x1="12" y1="11" x2="12" y2="17"></line>
                        <line x1="9" y1="14" x2="15" y2="14"></line>
                    </svg>
                    Add Category
                </button>
                <button class="add-product-btn" onclick="openAddProductModal()">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                        <line x1="12" y1="5" x2="12" y2="19"></line>
                        <line x1="5" y1="12" x2="19" y2="12"></line>
                    </svg>
                    Add New Product
                </button>
            </div>
        </div>

        <!-- Products Grid -->
        <div class="products-grid" id="productsGrid">
            <!-- Products will be loaded here dynamically -->
        </div>

        <!-- Empty State -->
        <div class="empty-state" id="emptyState" style="display: none;">
            <h3>No Products Found</h3>
            <p>Start by adding your first product to the inventory.</p>
        </div>
    </div>

    <!-- Product Modal -->
    <div class="modal-overlay" id="productModal">
        <div class="product-modal">
            <div class="modal-header">
                <h2 class="modal-title" id="modalTitle">Add New Product</h2>
                <button id="closeProductModalBtn" class="close-btn" onclick="closeProductModal()">&times;</button>
            </div>
            <div class="modal-content">
            
            <form id="productForm">
                <div class="form-group">
                    <label class="form-label" for="productTitle">Product Title *</label>
                    <input type="text" class="form-input" id="productTitle" required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="productDescription">Description</label>
                    <textarea class="form-textarea" id="productDescription" placeholder="Enter product description..."></textarea>
                </div>

                <div class="form-group">
                    <label class="form-label" for="productPrice">Price (â‚±) *</label>
                    <input type="number" class="form-input" id="productPrice" step="0.01" min="0" required>
                </div>

                <div class="form-group">
                    <label class="form-label" for="productCategory">Category *</label>
                    <select class="form-select" id="productCategory" required>
                        <option value="">Select Category</option>
                        <!-- Categories will be loaded dynamically -->
                    </select>
                </div>

                <div class="form-group">
                    <label class="form-label" for="productStock">Stock Quantity *</label>
                    <input type="number" class="form-input" id="productStock" min="0" value="0" required>
                    <small class="form-help-text">Initial stock quantity for this product</small>
                </div>

                <div class="form-group">
                    <label class="form-label">Product Images</label>
                    
                    <!-- Image Upload Options -->
                    <div class="image-upload-section">
                        <div class="upload-option">
                            <label class="form-label" for="productImages">Upload Files (Multiple)</label>
                            <input type="file" class="form-input file-input" id="productImages" accept="image/*" multiple>
                            <small class="form-help-text">Select multiple image files</small>
                        </div>
                        
                        <div class="upload-option">
                            <label class="form-label" for="productImageUrl">Add Image URL</label>
                            <div class="url-input-group">
                                <input type="url" class="form-input" id="productImageUrl" placeholder="https://example.com/image.jpg">
                                <button type="button" class="add-url-btn" onclick="addImageUrl()">Add URL</button>
                            </div>
                            <small class="form-help-text">Add images by URL one at a time</small>
                        </div>
                    </div>
                    
                    <!-- Image Preview Area -->
                    <div class="image-preview-container" id="imagePreviewContainer">
                        <div class="preview-header">
                            <span class="preview-title">Selected Images</span>
                            <button type="button" class="clear-all-btn" onclick="clearAllImages()">Clear All</button>
                        </div>
                        <div class="image-preview-grid" id="imagePreviewGrid">
                            <!-- Image previews will be added here -->
                        </div>
                    </div>
                </div>

                <div class="form-group">
                    <label class="form-label">3D Models (.glb files)</label>
                    
                    <!-- GLB Upload Options -->
                    <div class="glb-upload-section">
                        <div class="upload-option">
                            <label class="form-label" for="productGlbFiles">Upload .glb Files (Multiple)</label>
                            <input type="file" class="form-input file-input" id="productGlbFiles" accept=".glb" multiple onchange="handleGlbFileUpload(event)">
                            <small class="form-help-text">Select multiple .glb 3D model files</small>
                        </div>
                        
                        <div class="upload-option">
                            <label class="form-label" for="productGlbUrl">Add .glb File URL</label>
                            <div class="url-input-group">
                                <input type="url" class="form-input" id="productGlbUrl" placeholder="https://example.com/model.glb">
                                <button type="button" class="add-url-btn" onclick="addGlbUrl()">Add URL</button>
                            </div>
                            <small class="form-help-text">Add .glb files by URL one at a time</small>
                        </div>
                    </div>
                    
                    <!-- GLB Preview Area -->
                    <div class="glb-preview-container" id="glbPreviewContainer">
                        <div class="preview-header">
                            <span class="preview-title">Selected 3D Models</span>
                            <div class="preview-actions">
                                <button type="button" class="export-btn" onclick="exportAllPositioningData()" title="Export Positioning Data">
                                    <i class="fas fa-download"></i> Export
                                </button>
                                <input type="file" id="importPositioningFile" accept=".json" style="display: none;" onchange="handlePositioningImport(event)">
                                <button type="button" class="import-btn" onclick="document.getElementById('importPositioningFile').click()" title="Import Positioning Data">
                                    <i class="fas fa-upload"></i> Import
                                </button>
                                <button type="button" class="clear-all-btn" onclick="clearAllGlbFiles()">Clear All</button>
                            </div>
                        </div>
                        <div class="glb-preview-grid" id="glbPreviewGrid">
                            <!-- GLB file previews will be added here -->
                        </div>
                    </div>
                </div>


            </form>
            
            <div class="modal-actions">
                <button type="button" class="modal-btn cancel-btn" onclick="closeProductModal()">Cancel</button>
                <button type="submit" class="modal-btn save-btn" form="productForm">Save Product</button>
            </div>
            </div>
        </div>
    </div>

    <!-- GLB Positioning Modal -->
    <div id="glbPositioningModal" class="modal positioning-modal" style="display: none;">
        <div class="modal-content positioning-modal-content">
            <div class="modal-header">
                <h2>Position 3D Model on Face</h2>
                <button type="button" class="close-btn" onclick="closePositioningModal()">&times;</button>
            </div>
            
            <div class="positioning-workspace">
                <!-- Face Preview Area -->
                <div class="face-preview-section">
                    <div class="face-preview-container">
                        <div class="face-wireframe">
                            <!-- SVG Face Wireframe -->
                            <svg viewBox="0 0 300 400" class="face-svg">
                                <!-- Face outline -->
                                <ellipse cx="150" cy="200" rx="100" ry="130" fill="none" stroke="#540000" stroke-width="2" opacity="0.3"/>
                                
                                <!-- Eyes -->
                                <circle cx="120" cy="170" r="8" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.5"/>
                                <circle cx="180" cy="170" r="8" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.5"/>
                                
                                <!-- Nose -->
                                <path d="M150 180 L145 200 L150 205 L155 200 Z" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.5"/>
                                
                                <!-- Mouth -->
                                <path d="M130 230 Q150 240 170 230" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.5"/>
                                
                                <!-- Ears -->
                                <ellipse cx="80" cy="180" rx="15" ry="25" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.3"/>
                                <ellipse cx="220" cy="180" rx="15" ry="25" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.3"/>
                                
                                <!-- Forehead -->
                                <path d="M100 120 Q150 110 200 120" fill="none" stroke="#540000" stroke-width="1.5" opacity="0.3"/>
                                
                                <!-- Anchor Points -->
                                <g class="anchor-points">
                                    <circle cx="150" cy="120" r="6" class="anchor-point" data-anchor="forehead" data-index="10"/>
                                    <circle cx="150" cy="190" r="6" class="anchor-point" data-anchor="nose" data-index="6"/>
                                    <circle cx="150" cy="280" r="6" class="anchor-point" data-anchor="chin" data-index="175"/>
                                    <circle cx="80" cy="180" r="6" class="anchor-point" data-anchor="left-ear" data-index="127"/>
                                    <circle cx="220" cy="180" r="6" class="anchor-point" data-anchor="right-ear" data-index="356"/>
                                    <circle cx="150" cy="168" r="6" class="anchor-point selected" data-anchor="face-center" data-index="168"/>
                                </g>
                                
                                <!-- GLB Model Preview -->
                                <g class="glb-model-preview" transform="translate(150, 168) scale(1)">
                                    <rect x="-20" y="-10" width="40" height="20" fill="rgba(84, 0, 0, 0.7)" stroke="#540000" stroke-width="2" rx="5"/>
                                    <text x="0" y="5" text-anchor="middle" fill="white" font-size="10" font-weight="bold">GLB</text>
                                </g>
                            </svg>
                        </div>
                        
                        <div class="model-info">
                            <h4 id="currentModelName">No model selected</h4>
                            <p class="anchor-info">Anchor: <span id="currentAnchor">Face Center (168)</span></p>
                        </div>
                    </div>
                </div>
                
                <!-- Controls Section -->
                <div class="positioning-controls">
                    <div class="control-section">
                        <h3>Quick Anchor Points</h3>
                        <div class="anchor-buttons">
                            <button class="anchor-btn active" data-anchor="face-center" data-index="168">
                                <i class="fas fa-dot-circle"></i>
                                Face Center
                            </button>
                            <button class="anchor-btn" data-anchor="nose" data-index="6">
                                <i class="fas fa-circle"></i>
                                Nose Bridge
                            </button>
                            <button class="anchor-btn" data-anchor="forehead" data-index="10">
                                <i class="fas fa-circle"></i>
                                Forehead
                            </button>
                            <button class="anchor-btn" data-anchor="left-ear" data-index="127">
                                <i class="fas fa-circle"></i>
                                Left Ear
                            </button>
                            <button class="anchor-btn" data-anchor="right-ear" data-index="356">
                                <i class="fas fa-circle"></i>
                                Right Ear
                            </button>
                            <button class="anchor-btn" data-anchor="chin" data-index="175">
                                <i class="fas fa-circle"></i>
                                Chin
                            </button>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <h3>Position & Scale</h3>
                        <div class="control-group">
                            <label>Position X:</label>
                            <input type="range" id="positionX" min="-2" max="2" step="0.1" value="0" class="control-slider">
                            <span class="value-display" id="positionXValue">0</span>
                        </div>
                        <div class="control-group">
                            <label>Position Y:</label>
                            <input type="range" id="positionY" min="-2" max="2" step="0.1" value="0" class="control-slider">
                            <span class="value-display" id="positionYValue">0</span>
                        </div>
                        <div class="control-group">
                            <label>Position Z:</label>
                            <input type="range" id="positionZ" min="-1" max="1" step="0.1" value="0" class="control-slider">
                            <span class="value-display" id="positionZValue">0</span>
                        </div>
                        <div class="control-group">
                            <label>Scale:</label>
                            <input type="range" id="modelScale" min="0.1" max="3" step="0.1" value="1" class="control-slider">
                            <span class="value-display" id="modelScaleValue">1</span>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <h3>Rotation</h3>
                        <div class="control-group">
                            <label>Rotate X:</label>
                            <input type="range" id="rotationX" min="-180" max="180" step="5" value="0" class="control-slider">
                            <span class="value-display" id="rotationXValue">0Â°</span>
                        </div>
                        <div class="control-group">
                            <label>Rotate Y:</label>
                            <input type="range" id="rotationY" min="-180" max="180" step="5" value="0" class="control-slider">
                            <span class="value-display" id="rotationYValue">0Â°</span>
                        </div>
                        <div class="control-group">
                            <label>Rotate Z:</label>
                            <input type="range" id="rotationZ" min="-180" max="180" step="5" value="0" class="control-slider">
                            <span class="value-display" id="rotationZValue">0Â°</span>
                        </div>
                    </div>
                    
                    <div class="control-section">
                        <h3>Presets</h3>
                        <div class="preset-buttons">
                            <button class="preset-btn" onclick="applyPreset('glasses')">
                                <i class="fas fa-glasses"></i>
                                Glasses
                            </button>
                            <button class="preset-btn" onclick="applyPreset('hat')">
                                <i class="fas fa-hat-cowboy"></i>
                                Hat
                            </button>
                            <button class="preset-btn" onclick="applyPreset('earrings')">
                                <i class="fas fa-gem"></i>
                                Earrings
                            </button>
                            <button class="preset-btn" onclick="applyPreset('mask')">
                                <i class="fas fa-mask"></i>
                                Face Mask
                            </button>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="modal-actions">
                <button type="button" class="modal-btn cancel-btn" onclick="closePositioningModal()">Cancel</button>
                <button type="button" class="modal-btn reset-btn" onclick="resetPositioning()">Reset</button>
                <button type="button" class="modal-btn save-btn" onclick="savePositioning()">Apply Positioning</button>
            </div>
        </div>
    </div>

    <!-- Sidebar Manager Modal -->
    <div id="sidebarManagerModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>Manage Categories</h2>
                <button id="closeSidebarManagerBtn" class="close-btn">&times;</button>
            </div>
            <div class="modal-body">
                <div class="add-category-section">
                    <h3>Add New Category</h3>
                    <form id="addCategoryForm">
                        <div class="form-group">
                            <label for="categoryName">Category Name:</label>
                            <input type="text" id="categoryName" name="categoryName" required>
                        </div>
                        <div class="form-actions">
                            <button type="button" class="submit-btn" onclick="addCategoryFromForm()">Add Category</button>
                        </div>
                    </form>
                </div>
                <div class="existing-categories-section">
                    <h3>Existing Categories</h3>
                    <div id="existingCategories"></div>
                </div>
            </div>
        </div>
    </div>

    <script src="JS/ContentEditingFunc.js"></script>
    <script src="JS/EventListenerFunc.js"></script>
    <script src="JS/FrameEditingModal.js"></script>
    <script src="JS/NotificationFunc.js"></script>
    <script src="JS/PassToggleFunc.js"></script>
    <script src="JS/Script.js"></script>
    <script src="JS/SeachFunc.js"></script>
    <script src="JS/SidebarFunc.js"></script>
    <script src="JS/admin-dashboard.js"></script>
    <script src="JS/glb-positioning.js"></script>
</body>
</html>