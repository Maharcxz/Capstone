<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Pre-Ordering - Trinity Optimum Vision Center</title>

    <link href="https://fonts.googleapis.com/css2?family=Cinzel:wght@300;400;700&family=Poppins:wght@400;600&display=swap" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">

    <link rel="stylesheet" href="CSS/BaseStyles.css">
    <link rel="stylesheet" href="CSS/AboutUsPageStyles.css">
    <link rel="stylesheet" href="CSS/AdminPageStyles.css">
    <link rel="stylesheet" href="CSS/ConfirmationStyles.css">
    <link rel="stylesheet" href="CSS/ContactUsPageStyles.css">
    <link rel="stylesheet" href="CSS/FrameEditStyles.css">
    <link rel="stylesheet" href="CSS/FrameTypesMenuHeaderStyles.css">
    <link rel="stylesheet" href="CSS/HeaderStyles.css">
    <link rel="stylesheet" href="CSS/LogInModalStyles.css">
    <link rel="stylesheet" href="CSS/NotificationIconPanelStyles.css">
    <link rel="stylesheet" href="CSS/Pre-OrderStyles.css">
    <link rel="stylesheet" href="CSS/ProductGridStyles.css">
    <link rel="stylesheet" href="CSS/ResponsiveNotifStyles.css">
    <link rel="stylesheet" href="CSS/SidebarStyles.css">

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.10/firebase-database-compat.js"></script>
    
    <!-- Firebase Configuration (must be loaded first) -->
    <script src="JS/FirebaseConfig.js"></script>
    
    <!-- Application Scripts (loaded after Firebase is initialized) -->
    <script src="JS/AuthHandlers.js"></script>
    <script src="JS/ContentEditingFunc.js"></script>
    <script src="JS/EventListenerFunc.js"></script>
    <script src="JS/FrameCategoryFunc.js"></script>
    <script src="JS/FrameEditingModal.js"></script>
    <script src="JS/NotificationFunc.js"></script>
    <script src="JS/PassToggleFunc.js"></script>
    <script src="JS/Script.js"></script>
    <script src="JS/SeachFunc.js"></script>
    <script src="JS/SidebarFunc.js"></script>
</head>
<body>
    <div class="container">
        <!-- Header -->
        <header class="header">
            <div class="logo">
                <h1 class="maintitle">T R I N I T Y</h1>
                <p class="subtitle">OPTIMUM VISION CENTER</p>
            </div>
            <nav class="nav">
                <div class="nav-left">
                    <a href="index.html" class="nav-link">Home</a>
                    <a href="contact.html" class="nav-link">Contact Us</a>
                    <a href="about.html" class="nav-link">About Us</a>
                    <a href="admin-dashboard.html" class="nav-link admin-only" id="adminDashboardNav" style="display: none;">Admin Dashboard</a>
                    <a href="preorders.html" class="nav-link admin-only" id="preOrdersNav" style="display: none;">Pre-Orders</a>
                </div>
                <div class="nav-right">
                    <div class="nav-icons">
                        <span class="mail-icon">‚úâ</span>
                    </div>
                    <a href="login.html" class="login-btn">
                        <span class="user-icon">üë§</span>
                        Log In
                    </a>
                </div>
            </nav>
        </header>

        <!-- Login Modal -->
        <div class="login-modal-overlay" id="loginModalOverlay" onclick="hideLoginModal()">
            <div class="login-modal" onclick="event.stopPropagation()">
                <div class="modal-header">
                    <div class="glasses-icon">
                        <svg viewBox="0 0 100 60" class="glasses-svg">
                            <path d="M15 25 Q50 15 85 25 Q90 30 85 35 Q80 40 70 40 L60 40 Q55 35 50 35 Q45 35 40 40 L30 40 Q20 40 15 35 Q10 30 15 25 Z" 
                                fill="none" stroke="white" stroke-width="3"/>
                            <circle cx="25" cy="32" r="12" fill="none" stroke="white" stroke-width="3"/>
                            <circle cx="75" cy="32" r="12" fill="none" stroke="white" stroke-width="3"/>
                            <rect x="68" y="25" width="14" height="14" rx="2" fill="none" stroke="white" stroke-width="2"/>
                            <text x="75" y="34" text-anchor="middle" fill="white" font-size="8" font-weight="bold">AR</text>
                        </svg>
                    </div>
                    <h2 class="modal-title">WELCOME</h2>
                </div>
                
                <form class="login-form">
                    <div class="input-group">
                        <span class="input-icon">‚úâ</span>
                        <input type="email" placeholder="Email Address" class="login-input" required>
                    </div>
                    
                    <div class="input-group">
                        <span class="input-icon">üîí</span>
                        <input type="password" placeholder="Password" class="login-input" id="passwordInput" required>
                        <span class="password-toggle" onclick="togglePassword()">üëÅ</span>
                    </div>
                    
                    <button type="submit" class="modal-login-btn">Log In</button>
                    
                    <div class="guest-option">
                        <span class="continue-text">Or continue as</span>
                        <button type="button" class="guest-btn" onclick="hideLoginModal()">Guest</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Pre-Order Content -->
        <main class="preorder-content">
            <h2 class="preorder-page-title">PRE-ORDERING</h2>
            
            <div class="preorder-form-container">
                <form class="preorder-page-form" id="preorderForm">
                    <div class="form-row">
                        <div class="form-column">
                            <div class="form-field">
                                <label class="field-label">Full Name</label>
                                <div class="name-inputs">
                                    <input type="text" placeholder="First Name" class="name-input" name="firstName" id="firstName" required>
                                    <input type="text" placeholder="Last Name" class="name-input" name="lastName" id="lastName" required>
                                </div>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Email</label>
                                <input type="email" placeholder="email@example.com" class="full-input" name="email" id="email" required>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Phone Number</label>
                                <input type="tel" placeholder="+63" class="full-input" name="phone" id="phone" required>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Frame Name</label>
                                <input type="text" placeholder="Frame Name or Model" class="full-input" name="frameName" id="frameName">
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Quantity</label>
                                <select class="quantity-select" name="quantity" id="quantity" required>
                                    <option value="">Select Quantity</option>
                                    <option value="1">1</option>
                                    <option value="2">2</option>
                                    <option value="3">3</option>
                                    <option value="4">4</option>
                                    <option value="5">5</option>
                                    <option value="6">6</option>
                                    <option value="7">7</option>
                                    <option value="8">8</option>
                                    <option value="9">9</option>
                                    <option value="10">10+</option>
                                </select>
                            </div>
                        </div>
                        
                        <div class="form-column">
                            <div class="form-field">
                                <label class="field-label">Prescription (Optional)</label>
                                <textarea placeholder="Enter prescription details if available..." class="note-textarea" name="prescription" id="prescription"></textarea>
                            </div>
                            
                            <div class="form-field">
                                <label class="field-label">Additional Notes</label>
                                <textarea placeholder="Add your note here..." class="note-textarea" name="notes" id="notes"></textarea>
                            </div>
                        </div>
                    </div>
                    
                    <div class="form-actions">
                        <button type="button" class="cancel-btn" onclick="window.history.back()">Cancel</button>
                        <button type="submit" class="submit-btn">Submit</button>
                    </div>
                    
                    <div id="formMessage" class="form-message"></div>
                </form>
            </div>
        </main>
    </div>
    
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            const preorderForm = document.getElementById('preorderForm');
            
            if (preorderForm) {
                preorderForm.addEventListener('submit', function(e) {
                    e.preventDefault();
                    
                    // Get form values
                    const firstName = document.getElementById('firstName').value;
                    const lastName = document.getElementById('lastName').value;
                    const email = document.getElementById('email').value;
                    const phone = document.getElementById('phone').value;
                    const frameName = document.getElementById('frameName').value;
                    const quantity = document.getElementById('quantity').value;
                    const prescription = document.getElementById('prescription').value;
                    const notes = document.getElementById('notes').value;
                    
                    // Create pre-order object
                    const preOrder = {
                        firstName: firstName,
                        lastName: lastName,
                        email: email,
                        phone: phone,
                        frameName: frameName,
                        quantity: quantity,
                        prescription: prescription,
                        notes: notes,
                        date: new Date().toISOString(),
                        status: 'pending'
                    };
                    
                    // Save to Firebase
                    savePreOrderToFirebase(preOrder);
                });
            }
        });
        
        // Function to save pre-order to Firebase
        function savePreOrderToFirebase(preOrder) {
            const preOrdersRef = firebase.database().ref('preOrders');
            const formMessage = document.getElementById('formMessage');
            
            // Show loading message
            formMessage.textContent = 'Submitting your pre-order...';
            formMessage.className = 'form-message info';
            
            // Push data to Firebase
            preOrdersRef.push(preOrder)
                .then((result) => {
                    console.log('Pre-order saved successfully with ID:', result.key);
                    
                    // Show success message
                    formMessage.textContent = 'Pre-order submitted successfully!';
                    formMessage.className = 'form-message success';
                    
                    // Reset form
                    document.getElementById('preorderForm').reset();
                    
                    // Redirect to confirmation page after a short delay
                    setTimeout(() => {
                        window.location.href = `preorder-confirmation.html?frameName=${encodeURIComponent(preOrder.frameName)}`;
                    }, 1500);
                })
                .catch((error) => {
                    console.error('Error saving pre-order:', error);
                    
                    // Show error message
                    formMessage.textContent = 'Error submitting pre-order. Please try again.';
                    formMessage.className = 'form-message error';
                });
        }
    </script>
</html>